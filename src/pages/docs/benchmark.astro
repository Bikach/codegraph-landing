---
import DocsLayout from '../../layouts/Docs.astro';
import CodeBlock from '../../components/docs/CodeBlock.astro';
import Callout from '../../components/docs/Callout.astro';
import PrevNext from '../../components/docs/PrevNext.astro';
---

<DocsLayout title="Benchmark">
  <h1 class="text-4xl font-bold text-white mb-4">Benchmark Results</h1>
  <p class="text-xl text-gray-400 mb-8">
    Performance comparison of Claude Code with and without CodeGraph MCP integration.
  </p>

  <!-- Key Results -->
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-white mb-6">Key Results</h2>
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
      <div class="bg-gradient-to-br from-emerald-900/50 to-emerald-950/50 border border-emerald-700/50 rounded-xl p-6 text-center">
        <div class="text-4xl font-bold text-emerald-400 mb-2">45%</div>
        <div class="text-sm text-gray-400">Fewer LLM Calls</div>
      </div>
      <div class="bg-gradient-to-br from-purple-900/50 to-purple-950/50 border border-purple-700/50 rounded-xl p-6 text-center">
        <div class="text-4xl font-bold text-purple-400 mb-2">46%</div>
        <div class="text-sm text-gray-400">Fewer Tokens</div>
      </div>
      <div class="bg-gradient-to-br from-blue-900/50 to-blue-950/50 border border-blue-700/50 rounded-xl p-6 text-center">
        <div class="text-4xl font-bold text-blue-400 mb-2">41%</div>
        <div class="text-sm text-gray-400">Cost Reduction</div>
      </div>
      <div class="bg-gradient-to-br from-amber-900/50 to-amber-950/50 border border-amber-700/50 rounded-xl p-6 text-center">
        <div class="text-4xl font-bold text-amber-400 mb-2">51%</div>
        <div class="text-sm text-gray-400">Faster</div>
      </div>
    </div>
  </section>

  <!-- Overview -->
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-white mb-4">Overview</h2>
    <p class="text-gray-300 mb-4">
      We conducted a comprehensive benchmark comparing Claude Code's performance on common code
      analysis tasks with and without CodeGraph MCP. The tests were run on a medium-sized
      TypeScript/Kotlin codebase with approximately 50,000 lines of code.
    </p>
    <p class="text-gray-300">
      The results demonstrate significant improvements across all metrics when using CodeGraph's
      graph-based analysis compared to traditional file-by-file exploration.
    </p>
  </section>

  <!-- Detailed Results Table -->
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-white mb-6">Detailed Results by Scenario</h2>
    <div class="overflow-x-auto">
      <table class="w-full border-collapse">
        <thead>
          <tr class="border-b border-gray-700">
            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-300 bg-gray-800/50">Scenario</th>
            <th class="px-4 py-3 text-right text-sm font-semibold text-emerald-400 bg-gray-800/50">With MCP</th>
            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-400 bg-gray-800/50">Without MCP</th>
            <th class="px-4 py-3 text-right text-sm font-semibold text-purple-400 bg-gray-800/50">Savings</th>
          </tr>
        </thead>
        <tbody>
          <tr class="border-b border-gray-800 hover:bg-gray-800/30 transition-colors">
            <td class="px-4 py-4 text-gray-300">
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-lg bg-blue-900/50 flex items-center justify-center">
                  <svg class="w-4 h-4 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                  </svg>
                </div>
                <span>Find Callers</span>
              </div>
            </td>
            <td class="px-4 py-4 text-right text-emerald-400 font-mono">$0.066</td>
            <td class="px-4 py-4 text-right text-gray-400 font-mono">$0.073</td>
            <td class="px-4 py-4 text-right">
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-900/50 text-green-400">
                9%
              </span>
            </td>
          </tr>
          <tr class="border-b border-gray-800 hover:bg-gray-800/30 transition-colors">
            <td class="px-4 py-4 text-gray-300">
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-lg bg-purple-900/50 flex items-center justify-center">
                  <svg class="w-4 h-4 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"/>
                  </svg>
                </div>
                <span>Find Implementations</span>
              </div>
            </td>
            <td class="px-4 py-4 text-right text-emerald-400 font-mono">$0.043</td>
            <td class="px-4 py-4 text-right text-gray-400 font-mono">$0.070</td>
            <td class="px-4 py-4 text-right">
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-900/50 text-green-400">
                38%
              </span>
            </td>
          </tr>
          <tr class="border-b border-gray-800 hover:bg-gray-800/30 transition-colors">
            <td class="px-4 py-4 text-gray-300">
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-lg bg-red-900/50 flex items-center justify-center">
                  <svg class="w-4 h-4 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                  </svg>
                </div>
                <span>Impact Analysis</span>
              </div>
            </td>
            <td class="px-4 py-4 text-right text-emerald-400 font-mono">$0.187</td>
            <td class="px-4 py-4 text-right text-gray-400 font-mono">$0.337</td>
            <td class="px-4 py-4 text-right">
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-900/50 text-green-400">
                44%
              </span>
            </td>
          </tr>
          <tr class="border-b border-gray-800 hover:bg-gray-800/30 transition-colors">
            <td class="px-4 py-4 text-gray-300">
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-lg bg-amber-900/50 flex items-center justify-center">
                  <svg class="w-4 h-4 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"/>
                  </svg>
                </div>
                <span>Dependency Analysis</span>
              </div>
            </td>
            <td class="px-4 py-4 text-right text-emerald-400 font-mono">$0.114</td>
            <td class="px-4 py-4 text-right text-gray-400 font-mono">$0.193</td>
            <td class="px-4 py-4 text-right">
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-900/50 text-green-400">
                41%
              </span>
            </td>
          </tr>
          <tr class="border-b border-gray-800 hover:bg-gray-800/30 transition-colors">
            <td class="px-4 py-4 text-gray-300">
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-lg bg-cyan-900/50 flex items-center justify-center">
                  <svg class="w-4 h-4 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                  </svg>
                </div>
                <span>Call Chain</span>
              </div>
            </td>
            <td class="px-4 py-4 text-right text-emerald-400 font-mono">$0.136</td>
            <td class="px-4 py-4 text-right text-gray-400 font-mono">$0.252</td>
            <td class="px-4 py-4 text-right">
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-900/50 text-green-400">
                46%
              </span>
            </td>
          </tr>
        </tbody>
        <tfoot>
          <tr class="bg-gradient-to-r from-emerald-900/20 to-purple-900/20">
            <td class="px-4 py-4 text-white font-semibold">Total</td>
            <td class="px-4 py-4 text-right text-emerald-400 font-mono font-bold">$0.55</td>
            <td class="px-4 py-4 text-right text-gray-400 font-mono font-bold">$0.92</td>
            <td class="px-4 py-4 text-right">
              <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-bold bg-gradient-to-r from-emerald-600 to-purple-600 text-white">
                41% saved
              </span>
            </td>
          </tr>
        </tfoot>
      </table>
    </div>
  </section>

  <!-- Methodology -->
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-white mb-4">Methodology</h2>
    <div class="space-y-4 text-gray-300">
      <p>
        Each scenario was executed 10 times with both configurations, and the results were averaged
        to ensure statistical significance. The tests were performed under identical conditions:
      </p>
      <ul class="list-disc list-inside space-y-2 ml-4">
        <li>Same codebase snapshot (commit hash frozen)</li>
        <li>Same Claude model (claude-sonnet-4-20250514)</li>
        <li>Same prompts and queries</li>
        <li>Fresh context window for each test run</li>
        <li>Network latency controlled via local LLM proxy</li>
      </ul>
    </div>

    <Callout type="info" title="Cost Calculation">
      Costs are calculated based on Anthropic's published API pricing at the time of testing.
      Token counts include both input and output tokens. The "With MCP" configuration uses
      CodeGraph tools which return structured data, reducing the need for multiple file reads.
    </Callout>
  </section>

  <!-- Why It Works -->
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-white mb-4">Why CodeGraph is More Efficient</h2>
    <div class="grid md:grid-cols-2 gap-6">
      <div class="bg-gray-800/50 border border-gray-700 rounded-xl p-6">
        <div class="flex items-center gap-3 mb-4">
          <div class="w-10 h-10 rounded-lg bg-red-900/50 flex items-center justify-center">
            <svg class="w-5 h-5 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </div>
          <h3 class="text-lg font-semibold text-white">Without CodeGraph</h3>
        </div>
        <ul class="space-y-2 text-gray-400 text-sm">
          <li class="flex items-start gap-2">
            <span class="text-red-400 mt-1">*</span>
            <span>Multiple grep/find operations to locate code</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-red-400 mt-1">*</span>
            <span>Full file reads to understand context</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-red-400 mt-1">*</span>
            <span>Iterative exploration to find relationships</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-red-400 mt-1">*</span>
            <span>May miss indirect dependencies</span>
          </li>
        </ul>
      </div>
      <div class="bg-gray-800/50 border border-gray-700 rounded-xl p-6">
        <div class="flex items-center gap-3 mb-4">
          <div class="w-10 h-10 rounded-lg bg-emerald-900/50 flex items-center justify-center">
            <svg class="w-5 h-5 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
          </div>
          <h3 class="text-lg font-semibold text-white">With CodeGraph</h3>
        </div>
        <ul class="space-y-2 text-gray-400 text-sm">
          <li class="flex items-start gap-2">
            <span class="text-emerald-400 mt-1">*</span>
            <span>Single query returns all relationships</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-emerald-400 mt-1">*</span>
            <span>Compact structured output (no file bloat)</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-emerald-400 mt-1">*</span>
            <span>Pre-indexed graph enables instant lookups</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-emerald-400 mt-1">*</span>
            <span>Complete transitive dependency analysis</span>
          </li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Reproduce -->
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-white mb-4">Reproduce the Benchmark</h2>
    <p class="text-gray-300 mb-4">
      You can run the benchmark yourself on your own codebase. The benchmark scripts are available
      in the CodeGraph repository.
    </p>
    <CodeBlock
      code={`# Clone the benchmark suite
git clone https://github.com/Bikach/codegraph-benchmark
cd codegraph-benchmark

# Run benchmarks on your project
./run-benchmark.sh /path/to/your/project`}
      lang="bash"
      title="Terminal"
    />
  </section>

  <PrevNext prev={{ title: "Java", href: "/docs/languages/java" }} next={null} />
</DocsLayout>

<style>
  table {
    border-radius: 0.75rem;
    overflow: hidden;
    border: 1px solid rgb(55 65 81);
  }

  thead tr:first-child th:first-child {
    border-top-left-radius: 0.75rem;
  }

  thead tr:first-child th:last-child {
    border-top-right-radius: 0.75rem;
  }

  tfoot tr:last-child td:first-child {
    border-bottom-left-radius: 0.75rem;
  }

  tfoot tr:last-child td:last-child {
    border-bottom-right-radius: 0.75rem;
  }
</style>
