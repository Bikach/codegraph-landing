---
import DocsLayout from '../../layouts/Docs.astro';
import CodeBlock from '../../components/docs/CodeBlock.astro';
import Callout from '../../components/docs/Callout.astro';
import PrevNext from '../../components/docs/PrevNext.astro';
---

<DocsLayout title="Benchmark">
  <h1 class="text-4xl font-bold text-text-primary mb-4">Benchmark Results</h1>
  <p class="text-xl text-text-secondary mb-8">
    Performance comparison of Claude Code with and without CodeGraph MCP integration.
  </p>

  <!-- Key Results -->
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-text-primary mb-6">Key Results</h2>
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
      <div class="glass-card p-6 text-center border-l-4 border-l-secondary">
        <div class="text-4xl font-bold text-secondary mb-2">45%</div>
        <div class="text-sm text-text-secondary">Fewer LLM Calls</div>
      </div>
      <div class="glass-card p-6 text-center border-l-4 border-l-primary">
        <div class="text-4xl font-bold text-primary mb-2">46%</div>
        <div class="text-sm text-text-secondary">Fewer Tokens</div>
      </div>
      <div class="glass-card p-6 text-center border-l-4 border-l-accent">
        <div class="text-4xl font-bold text-accent mb-2">41%</div>
        <div class="text-sm text-text-secondary">Cost Reduction</div>
      </div>
      <div class="glass-card p-6 text-center border-l-4 border-l-attention">
        <div class="text-4xl font-bold text-attention mb-2">51%</div>
        <div class="text-sm text-text-secondary">Faster</div>
      </div>
    </div>
  </section>

  <!-- Overview -->
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-text-primary mb-4">Overview</h2>
    <p class="text-text-secondary mb-4">
      We conducted a comprehensive benchmark comparing Claude Code's performance on common code
      analysis tasks with and without CodeGraph MCP. The tests were run on a medium-sized
      TypeScript/Kotlin codebase with approximately 50,000 lines of code.
    </p>
    <p class="text-text-secondary">
      The results demonstrate significant improvements across all metrics when using CodeGraph's
      graph-based analysis compared to traditional file-by-file exploration.
    </p>
  </section>

  <!-- Detailed Results Table -->
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-text-primary mb-6">Detailed Results by Scenario</h2>
    <div class="overflow-x-auto">
      <table class="w-full text-sm text-left text-text-secondary">
        <thead class="text-xs uppercase bg-bg-subtle text-text-muted">
          <tr>
            <th class="py-3 px-4 rounded-tl-lg">Scenario</th>
            <th class="py-3 px-4 text-right text-secondary">With MCP</th>
            <th class="py-3 px-4 text-right">Without MCP</th>
            <th class="py-3 px-4 text-right rounded-tr-lg text-primary">Savings</th>
          </tr>
        </thead>
        <tbody class="bg-bg-subtle">
          <tr class="border-b border-border hover:bg-bg-canvas/50 transition-colors">
            <td class="py-4 px-4 text-text-primary">
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-lg bg-accent/20 flex items-center justify-center">
                  <svg class="w-4 h-4 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                  </svg>
                </div>
                <span>Find Callers</span>
              </div>
            </td>
            <td class="py-4 px-4 text-right text-secondary font-mono">$0.066</td>
            <td class="py-4 px-4 text-right text-text-muted font-mono">$0.073</td>
            <td class="py-4 px-4 text-right">
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-secondary/20 text-secondary">
                9%
              </span>
            </td>
          </tr>
          <tr class="border-b border-border hover:bg-bg-canvas/50 transition-colors">
            <td class="py-4 px-4 text-text-primary">
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-lg bg-primary/20 flex items-center justify-center">
                  <svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"/>
                  </svg>
                </div>
                <span>Find Implementations</span>
              </div>
            </td>
            <td class="py-4 px-4 text-right text-secondary font-mono">$0.043</td>
            <td class="py-4 px-4 text-right text-text-muted font-mono">$0.070</td>
            <td class="py-4 px-4 text-right">
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-secondary/20 text-secondary">
                38%
              </span>
            </td>
          </tr>
          <tr class="border-b border-border hover:bg-bg-canvas/50 transition-colors">
            <td class="py-4 px-4 text-text-primary">
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-lg bg-danger/20 flex items-center justify-center">
                  <svg class="w-4 h-4 text-danger" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                  </svg>
                </div>
                <span>Impact Analysis</span>
              </div>
            </td>
            <td class="py-4 px-4 text-right text-secondary font-mono">$0.187</td>
            <td class="py-4 px-4 text-right text-text-muted font-mono">$0.337</td>
            <td class="py-4 px-4 text-right">
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-secondary/20 text-secondary">
                44%
              </span>
            </td>
          </tr>
          <tr class="border-b border-border hover:bg-bg-canvas/50 transition-colors">
            <td class="py-4 px-4 text-text-primary">
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-lg bg-attention/20 flex items-center justify-center">
                  <svg class="w-4 h-4 text-attention" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"/>
                  </svg>
                </div>
                <span>Dependency Analysis</span>
              </div>
            </td>
            <td class="py-4 px-4 text-right text-secondary font-mono">$0.114</td>
            <td class="py-4 px-4 text-right text-text-muted font-mono">$0.193</td>
            <td class="py-4 px-4 text-right">
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-secondary/20 text-secondary">
                41%
              </span>
            </td>
          </tr>
          <tr class="border-b border-border hover:bg-bg-canvas/50 transition-colors">
            <td class="py-4 px-4 text-text-primary">
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-lg bg-accent/20 flex items-center justify-center">
                  <svg class="w-4 h-4 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                  </svg>
                </div>
                <span>Call Chain</span>
              </div>
            </td>
            <td class="py-4 px-4 text-right text-secondary font-mono">$0.136</td>
            <td class="py-4 px-4 text-right text-text-muted font-mono">$0.252</td>
            <td class="py-4 px-4 text-right">
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-secondary/20 text-secondary">
                46%
              </span>
            </td>
          </tr>
        </tbody>
        <tfoot>
          <tr class="bg-bg-canvas">
            <td class="py-4 px-4 text-text-primary font-semibold rounded-bl-lg">Total</td>
            <td class="py-4 px-4 text-right text-secondary font-mono font-bold">$0.55</td>
            <td class="py-4 px-4 text-right text-text-muted font-mono font-bold">$0.92</td>
            <td class="py-4 px-4 text-right rounded-br-lg">
              <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-bold bg-secondary text-white">
                41% saved
              </span>
            </td>
          </tr>
        </tfoot>
      </table>
    </div>
  </section>

  <!-- Methodology -->
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-text-primary mb-4">Methodology</h2>
    <div class="space-y-4 text-text-secondary">
      <p>
        Each scenario was executed 10 times with both configurations, and the results were averaged
        to ensure statistical significance. The tests were performed under identical conditions:
      </p>
      <ul class="list-disc list-inside space-y-2 ml-4">
        <li>Same codebase snapshot (commit hash frozen)</li>
        <li>Same Claude model (claude-sonnet-4-20250514)</li>
        <li>Same prompts and queries</li>
        <li>Fresh context window for each test run</li>
        <li>Network latency controlled via local LLM proxy</li>
      </ul>
    </div>

    <Callout type="info" title="Cost Calculation">
      Costs are calculated based on Anthropic's published API pricing at the time of testing.
      Token counts include both input and output tokens. The "With MCP" configuration uses
      CodeGraph tools which return structured data, reducing the need for multiple file reads.
    </Callout>
  </section>

  <!-- Why It Works -->
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-text-primary mb-4">Why CodeGraph is More Efficient</h2>
    <div class="grid md:grid-cols-2 gap-6">
      <div class="glass-card p-6 border-l-4 border-l-danger">
        <div class="flex items-center gap-3 mb-4">
          <div class="w-10 h-10 rounded-lg bg-danger/20 flex items-center justify-center">
            <svg class="w-5 h-5 text-danger" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </div>
          <h3 class="text-lg font-semibold text-text-primary">Without CodeGraph</h3>
        </div>
        <ul class="space-y-2 text-text-secondary text-sm">
          <li class="flex items-start gap-2">
            <span class="text-danger mt-1">*</span>
            <span>Multiple grep/find operations to locate code</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-danger mt-1">*</span>
            <span>Full file reads to understand context</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-danger mt-1">*</span>
            <span>Iterative exploration to find relationships</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-danger mt-1">*</span>
            <span>May miss indirect dependencies</span>
          </li>
        </ul>
      </div>
      <div class="glass-card p-6 border-l-4 border-l-secondary">
        <div class="flex items-center gap-3 mb-4">
          <div class="w-10 h-10 rounded-lg bg-secondary/20 flex items-center justify-center">
            <svg class="w-5 h-5 text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
          </div>
          <h3 class="text-lg font-semibold text-text-primary">With CodeGraph</h3>
        </div>
        <ul class="space-y-2 text-text-secondary text-sm">
          <li class="flex items-start gap-2">
            <span class="text-secondary mt-1">*</span>
            <span>Single query returns all relationships</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-secondary mt-1">*</span>
            <span>Compact structured output (no file bloat)</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-secondary mt-1">*</span>
            <span>Pre-indexed graph enables instant lookups</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-secondary mt-1">*</span>
            <span>Complete transitive dependency analysis</span>
          </li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Reproduce -->
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-text-primary mb-4">Reproduce the Benchmark</h2>
    <p class="text-text-secondary mb-4">
      You can run the benchmark yourself on your own codebase. The benchmark scripts are available
      in the CodeGraph repository.
    </p>
    <CodeBlock
      code={`# Clone the benchmark suite
git clone https://github.com/Bikach/codegraph-benchmark
cd codegraph-benchmark

# Run benchmarks on your project
./run-benchmark.sh /path/to/your/project`}
      lang="bash"
      title="Terminal"
    />
  </section>

  <PrevNext prev={{ title: "Java", href: "/docs/languages/java" }} next={null} />
</DocsLayout>

<style>
  table {
    border-radius: 0.75rem;
    overflow: hidden;
  }
</style>
