---
import DocsLayout from '../../../layouts/Docs.astro';
import CodeBlock from '../../../components/docs/CodeBlock.astro';
import Callout from '../../../components/docs/Callout.astro';
import PrevNext from '../../../components/docs/PrevNext.astro';
---

<DocsLayout title="get_callers">
  <h1 class="text-4xl font-bold text-text-primary mb-4">
    get_callers
  </h1>
  <p class="text-xl text-text-secondary mb-8">
    Find all functions that call the specified function, with configurable trace depth.
  </p>

  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-text-primary mb-4">Description</h2>
    <p class="text-text-secondary mb-4">
      The <code class="text-primary bg-bg-subtle px-2 py-1 rounded">get_callers</code> tool traces the reverse call graph, showing all the functions that call a specific function directly and transitively (up to the specified depth). This is essential for understanding how a function is used throughout your codebase.
    </p>
    <p class="text-text-secondary">
      Results are returned in a compact format: <code class="text-primary bg-bg-subtle px-2 py-1 rounded">depth | Class.function() | filePath:line</code>
    </p>
  </section>

  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-text-primary mb-4">Parameters</h2>
    <div class="overflow-x-auto">
      <table class="w-full text-sm text-left text-text-secondary">
        <thead class="text-xs uppercase bg-bg-subtle text-text-muted">
          <tr>
            <th class="py-3 px-4 rounded-tl-lg">Parameter</th>
            <th class="py-3 px-4">Type</th>
            <th class="py-3 px-4">Required</th>
            <th class="py-3 px-4 rounded-tr-lg">Description</th>
          </tr>
        </thead>
        <tbody class="bg-bg-subtle">
          <tr class="border-b border-border">
            <td class="py-3 px-4 font-medium text-text-primary"><code class="text-primary">function_name</code></td>
            <td class="py-3 px-4">string</td>
            <td class="py-3 px-4"><span class="text-danger">Yes</span></td>
            <td class="py-3 px-4">Name of the function to find callers for</td>
          </tr>
          <tr class="border-b border-border">
            <td class="py-3 px-4 font-medium text-text-primary"><code class="text-primary">class_name</code></td>
            <td class="py-3 px-4">string</td>
            <td class="py-3 px-4"><span class="text-text-muted">No</span></td>
            <td class="py-3 px-4">Class containing the function (for disambiguation when multiple functions share the same name)</td>
          </tr>
          <tr class="border-b border-border">
            <td class="py-3 px-4 font-medium text-text-primary"><code class="text-primary">depth</code></td>
            <td class="py-3 px-4">integer</td>
            <td class="py-3 px-4"><span class="text-text-muted">No</span></td>
            <td class="py-3 px-4">Trace depth: 1 = direct callers only, up to 5 (default: 2)</td>
          </tr>
          <tr>
            <td class="py-3 px-4 font-medium text-text-primary"><code class="text-primary">project_path</code></td>
            <td class="py-3 px-4">string</td>
            <td class="py-3 px-4"><span class="text-text-muted">No</span></td>
            <td class="py-3 px-4">Filter by project path. If not provided, searches all indexed projects</td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-text-primary mb-4">Example</h2>
    <p class="text-text-secondary mb-4">
      Ask Claude to find all callers of a function. The depth column shows how many levels up each caller is from the original function.
    </p>
    <CodeBlock
      code={`⏺ codegraph:get_callers (MCP)(function_name: "findByEmail", depth: 2)

  ⎿  CALLERS (8):
     1 | LoginUseCase.execute() | .../usecase/LoginUseCase.kt:35
     1 | RegisterPatientUseCase.execute() | .../usecase/RegisterPatientUseCase.kt:42
     1 | ResetPasswordUseCase.execute() | .../usecase/ResetPasswordUseCase.kt:28
     2 | AuthController.login() | .../adapter/AuthController.kt:25
     2 | AuthController.register() | .../adapter/AuthController.kt:48
     2 | AuthController.resetPassword() | .../adapter/AuthController.kt:67
     2 | AuthIntegrationTest.shouldLogin() | .../test/AuthIntegrationTest.kt:34
     2 | AuthIntegrationTest.shouldRegister() | .../test/AuthIntegrationTest.kt:58`}
      lang="bash"
      title="Claude Code"
      copyable={false}
    />
  </section>

  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-text-primary mb-4">Use Cases</h2>
    <ul class="space-y-3 text-text-secondary">
      <li class="flex items-start gap-3">
        <span class="text-secondary mt-1">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
          </svg>
        </span>
        <span><strong class="text-text-primary">Impact analysis:</strong> Understand all the code that would be affected if you change a function's signature or behavior</span>
      </li>
      <li class="flex items-start gap-3">
        <span class="text-secondary mt-1">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
          </svg>
        </span>
        <span><strong class="text-text-primary">Refactoring:</strong> Identify all call sites before renaming or modifying a function</span>
      </li>
      <li class="flex items-start gap-3">
        <span class="text-secondary mt-1">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
          </svg>
        </span>
        <span><strong class="text-text-primary">Code review:</strong> Understand the context and usage patterns of a function during review</span>
      </li>
      <li class="flex items-start gap-3">
        <span class="text-secondary mt-1">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
          </svg>
        </span>
        <span><strong class="text-text-primary">Dead code detection:</strong> Find functions that have no callers and may be unused</span>
      </li>
    </ul>
  </section>

  <Callout type="tip" title="Depth Recommendation">
    Start with the default depth of 2 for most use cases. Increase to 3-5 only when you need to trace complex call chains, as deeper traces can return large amounts of data.
  </Callout>

  <PrevNext
    prev={{ title: "search_nodes", href: "/docs/tools/search-nodes" }}
    next={{ title: "get_callees", href: "/docs/tools/get-callees" }}
  />
</DocsLayout>
